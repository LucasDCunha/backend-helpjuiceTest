
<h1>Search Analytics</h1>

<div class="container">
  <%= form_with url: searches_path, method: :post, local: true do |f| %>
    <%= f.text_field :text, placeholder: "Type a search term...", autofocus: true %>
    <button id="clear-searches-btn" class="clear-searches-btn">Clear Searches</button>
  <% end %>

  <div id="popular-searches">
    <%= render partial: "popular_searches", locals: { popular_searches: @popular_searches } %>
  </div>
</div>

<script>
const clearBtn = document.getElementById("clear-searches-btn");

clearBtn.addEventListener("click", () => {
  if (!confirm("Are you sure you want to clear all searches?")) return;

  fetch("/searches/reset", {
    method: "DELETE",
    headers: {
      "X-CSRF-Token": document.querySelector("meta[name='csrf-token']").content
    }
  })
  .then(() => {
    // Opcional: limpar a lista da interface
    window.location.reload(); // ou vocÃª pode atualizar a lista via JS
  })
  .catch((err) => {
    console.error("Erro ao limpar buscas:", err);
  });
});
</script>
